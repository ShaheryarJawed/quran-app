<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Profile - DeenSphere</title>
    <!-- Fonts & Icons -->
    <link
        href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Outfit:wght@300;400;500;600&display=swap"
        rel="stylesheet">
    <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
    <!-- CSS -->
    <link rel="stylesheet" href="style.css?v=11.1">
    <style>
        .profile-header {
            background: linear-gradient(135deg, rgba(15, 23, 42, 0.9), rgba(15, 23, 42, 0.8)), url('images/quran_hero.png');
            background-size: cover;
            background-position: center;
            padding: 4rem 2rem;
            text-align: center;
            position: relative;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .profile-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            border: 4px solid #fbbf24;
            object-fit: cover;
            margin-bottom: 1rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        .profile-name {
            font-family: 'Amiri', serif;
            font-size: 2.5rem;
            color: #fbbf24;
            margin-bottom: 0.5rem;
        }

        .profile-email {
            color: #94a3b8;
            font-family: 'Outfit', sans-serif;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            max-width: 1000px;
            margin: -3rem auto 2rem;
            padding: 0 1rem;
            position: relative;
            z-index: 10;
        }

        .stat-card {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 1.5rem;
            border-radius: 16px;
            text-align: center;
            transition: transform 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            border-color: #fbbf24;
        }

        .stat-value {
            font-size: 2rem;
            color: white;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            color: #94a3b8;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .content-container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 2rem;
        }

        .section-title {
            font-size: 1.5rem;
            color: white;
            margin-bottom: 1.5rem;
            border-left: 4px solid #fbbf24;
            padding-left: 1rem;
        }

        .info-row {
            display: flex;
            justify-content: space-between;
            padding: 1rem 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            color: #cbd5e1;
        }

        .info-label {
            font-weight: 500;
            color: #94a3b8;
        }
    </style>
</head>

<body style="background:#0f172a; min-height:100vh;">

    <!-- Navbar (Simplified) -->
    <nav
        style="padding:1rem 2rem; display:flex; justify-content:space-between; align-items:center; background:rgba(15,23,42,0.9); border-bottom:1px solid rgba(255,255,255,0.05);">
        <a href="index.html"
            style="color:white; text-decoration:none; display:flex; align-items:center; gap:10px; font-weight:600;">
            <i class='bx bxs-moon' style="color:#fbbf24; font-size:1.5rem;"></i> DeenSphere
        </a>
        <a href="index.html" class="btn-portal-secondary"
            style="color:white; text-decoration:none; border:1px solid rgba(255,255,255,0.2); padding:0.5rem 1rem; border-radius:8px;">Back
            to Dashboard</a>
    </nav>

    <div id="profile-content">
        <!-- Header -->
        <div class="profile-header">
            <img id="p-avatar" src="" class="profile-avatar"
                onerror="this.src='https://ui-avatars.com/api/?name=User&background=fbbf24&color=0f172a'">
            <h1 id="p-name" class="profile-name">Loading...</h1>
            <p id="p-email" class="profile-email">...</p>
        </div>

        <!-- Stats -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-value">0</div>
                <div class="stat-label">Days Streak</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">0</div>
                <div class="stat-label">Saved Ayahs</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">Member</div>
                <div class="stat-label">Account Type</div>
            </div>
        </div>

        <!-- Details -->
        <div class="content-container">
            <h2 class="section-title">Account Details</h2>
            <div class="info-row">
                <span class="info-label">Full Name</span>
                <span id="d-name">...</span>
            </div>
            <div class="info-row">
                <span class="info-label">Email Address</span>
                <span id="d-email">...</span>
            </div>
            <div class="info-row">
                <span class="info-label">Member Since</span>
                <span id="d-joined">...</span>
            </div>
            <div class="info-row">
                <span class="info-label">Provider</span>
                <span id="d-provider" style="text-transform:capitalize;">...</span>
            </div>
        </div>

        <!-- Saved Items Section -->
        <div class="content-container" style="margin-top: 2rem;">
            <h2 class="section-title">Saved Favorites</h2>
            <div id="saved-list" style="display:grid; gap:1rem;">
                <!-- Items injected here -->
                <p style="color:#64748b; font-style:italic;">No saved items yet.</p>
            </div>
        </div>
    </div>

    <script>
        // Load Data
        document.addEventListener('DOMContentLoaded', () => {
            const user = JSON.parse(localStorage.getItem('currentUser'));
            if (!user) {
                window.location.href = 'auth.html';
                return;
            }

            // Profile Header
            document.getElementById('p-name').textContent = user.name;
            document.getElementById('p-email').textContent = user.email;
            document.getElementById('p-avatar').src = user.photo || `https://ui-avatars.com/api/?name=${user.name}&background=fbbf24&color=0f172a`;

            // Stats
            const saved = JSON.parse(localStorage.getItem('savedItems') || '[]');
            document.querySelector('.stat-card:nth-child(2) .stat-value').textContent = saved.length;

            // Details
            document.getElementById('d-name').textContent = user.name;
            document.getElementById('d-email').textContent = user.email;
            document.getElementById('d-provider').textContent = user.provider || 'Email';

            if (user.joined) {
                const date = new Date(user.joined);
                document.getElementById('d-joined').textContent = date.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
            } else {
                document.getElementById('d-joined').textContent = "Unknown";
            }

            // Render Saved Items
            const list = document.getElementById('saved-list');
            if (saved.length > 0) {
                list.innerHTML = saved.map(item => `
                    <div style="background:rgba(30,41,59,0.5); padding:1.5rem; border-radius:12px; border:1px solid rgba(255,255,255,0.05);">
                        <div style="display:flex; justify-content:space-between; margin-bottom:0.5rem;">
                            <span style="background:rgba(251,191,36,0.1); color:#fbbf24; padding:0.2rem 0.8rem; border-radius:50px; font-size:0.8rem; text-transform:uppercase; font-weight:700;">${item.type}</span>
                            <span style="color:#64748b; font-size:0.8rem;">${new Date(item.date).toLocaleDateString()}</span>
                        </div>
                        <p style="font-family:'Amiri', serif; font-size:1.5rem; color:white; margin-bottom:0.5rem; text-align:right;">${item.content.ar || ''}</p>
                        <p style="color:#cbd5e1; font-size:1rem;">${item.content.en || item.content}</p>
                    </div>
                `).join('');
            }
        });
    </script>
</body>

</html>